name: LaTeX to PDF
on: [push]
jobs:
  build_latex:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y \
            texlive-full \
            latexmk \
            fonts-noto-cjk \
            aspell \
            aspell-en
          sudo apt-get clean

      - name: Spellcheck with aspell
        run: |
          for file in *.tex; do
            echo "üîç Spellchecking $file..."
            aspell --lang=en --mode=tex list < "$file" | sort | uniq > "${file%.tex}.spellerrors"
            
            if [ -s "${file%.tex}.spellerrors" ]; then
              echo "::warning::Spelling errors found in $file"
              echo "‚ùå Misspelled words:"
              cat "${file%.tex}.spellerrors"
            else
              echo "‚úÖ No spelling errors found in $file"
            fi
          done

      - name: Compile with latexmk
        run: |
          latexmk -xelatex -synctex=1 -interaction=nonstopmode SAA_hw09.tex

      - name: Upload PDF artifact
        uses: actions/upload-artifact@v4
        with:
          name: PDF
          path: SAA_hw09.pdf
